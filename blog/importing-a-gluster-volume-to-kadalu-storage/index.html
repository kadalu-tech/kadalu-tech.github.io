

<!DOCTYPE HTML>
<html lang="en">
    <head>
    <meta name="viewport" content="width=device-width"/>
    <meta charSet="utf-8"/>
    <title>Importing a Gluster Volume to Kadalu Storage</title>
    <link rel="stylesheet" href="/bulma@1.0.0.min.css">
    <link rel="stylesheet" href="/stylesheet.css">
    <link rel="stylesheet" href="/syntax-highlight-emacs.css">
    <script defer src="/alpinejs-3.10.5.min.js"></script>

    <meta name="generator" content="Nanoc 4.12.20">
    
<link href="/favicon.ico" rel="icon" type="image/x-icon" />
<link rel="apple-touch-icon" href="/favicon.ico" />
<meta name="generator" content="Nanoc 4.12.20">
<meta property="og:title" content="Importing a Gluster Volume to Kadalu Storage"/>
<meta name="author" content="aravindavk"/>
<meta property="og:locale" content="en_US"/>
<meta name="description" content="Gluster Storage and Kadalu Storage share the same filesystem backend that is GlusterFS. Which makes it natural to think about migrating a Gluster Volume to Kadalu Volume."/>
<meta property="og:description" content="Gluster Storage and Kadalu Storage share the same filesystem backend that is GlusterFS. Which makes it natural to think about migrating a Gluster Volume to Kadalu Volume."/>
<link rel="canonical" href="/blog/importing-a-gluster-volume-to-kadalu-storage/"/>
<meta property="og:url" content="/blog/importing-a-gluster-volume-to-kadalu-storage/"/>
<meta property="og:site_name" content="Kadalu"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2022-01-25"/>

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://kadalu.tech/images/import-gluster-volume.png"/>
<meta property="og:image" content="https://kadalu.tech/images/import-gluster-volume.png"/>

<meta name="twitter:site" content="https://kadalu.tech"/>
<meta name="twitter:title" content="Importing a Gluster Volume to Kadalu Storage"/>
<meta name="twitter:description" content="Gluster Storage and Kadalu Storage share the same filesystem backend that is GlusterFS. Which makes it natural to think about migrating a Gluster Volume to Kadalu Volume."/>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />


    <script defer data-domain="kadalu.tech" src="https://plausible.io/js/plausible.js"></script>
</head>

    <body>
        <div id="main">
            <nav class="navbar" role="navigation" aria-label="main navigation" x-data="{showing: false}">
    <div class="navbar-brand" style="min-height: 70px">
        <a class="navbar-item" href="/">
            <img src="/images/logo.svg" style="max-height: 50px"/>
        </a>

        <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" :class="showing ? 'is-active' : ''" @click="showing = !showing" data-target="navbarBasicExample">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
        </a>
    </div>

    <div id="navbarBasicExample" class="navbar-menu" :class="showing ? 'is-active' : ''">
        <div class="navbar-end">
            <a class="navbar-item" href="/blog">
                Blog
            </a>

            <a class="navbar-item" href="/pricing">
                Pricing
            </a>

            <a class="navbar-item" href="/about">
                About Us
            </a>
        </div>
    </div>
    </div>
</nav>

            <div class="container is-max-desktop px-4" id="content">
                <div class="has-text-centered py-6">
                    <a href="/">
                        <figure class="image is-64x64" style="margin: auto">
                            <img class="is-rounded" src="https://github.com/aravindavk.png?size=300px">
                        </figure>
                        <p class="has-text-grey pb-6 is-size-6 is-uppercase">Aravinda VK</p>
                    </a>
                </div>

                <div class="">
                    <h1 class="title is-1 has-text-centered">Importing a Gluster Volume to Kadalu Storage</h1>
                    <div class="has-text-grey mb-1 has-text-centered">
                        Posted on <strong>Jan 25, 2022</strong> by <strong>Aravinda VK</strong>
                    </div>
                    <p class="has-text-centered">
                        <span class="icon-text">
                            <svg class="mr-1 icon" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path></svg>
                            <span><strong>3 minutes</strong> read.</span>
                        </span>
                    </p>
                    <div class="content py-6">
                        <div class="paragraph">
<p>Gluster Storage and Kadalu Storage share the same filesystem backend that is GlusterFS. Which makes it natural to think about migrating a Gluster Volume to Kadalu Volume.</p>
</div>
<div class="paragraph">
<p>Luckily both Kadalu Storage and Gluster Storage can co-exist. To experience Kadalu Storage, you can identify one Volume from the Gluster Cluster and migrate it to Kadalu Storage. At the end of this blog post I will also show how you can go back to Gluster&#8217;s way of managing that Volume.</p>
</div>
<div class="paragraph">
<p>Create a Volume in Gluster Cluster (I am skipping all the Peer probe steps and directly jump to creating the Volume)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">#</span><span class="w"> </span>gluster volume create vol1 replica 3   <span class="se">\</span>
<span class="go">    server1.example.com:/exports/vol1/s1 \
    server2.example.com:/exports/vol1/s2 \
    server3.example.com:/exports/vol1/s3</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Gluster CLI doesn&#8217;t support importing or creating a volume by specifying volume ID. Do not delete the Gluster Volume after migrating to Kadalu Storage. Keep the Gluster Volume in Stopped state.</p>
</div>
<div class="paragraph">
<p>Start Kadalu Storage manager in all Gluster Storage nodes, in this example Start in server1, server2 and server3.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">#</span><span class="w"> </span>systemctl <span class="nb">enable </span>kadalu-mgr
<span class="gp">#</span><span class="w"> </span>systemctl start kadalu-mgr</code></pre>
</div>
</div>
<div class="paragraph">
<p>Login to any one server and create a Storage Pool, Example <code>PROD</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">server1#</span><span class="w"> </span>kadalu pool create PROD</code></pre>
</div>
</div>
<div class="sect1">
<h2 id="_manual_migration">Manual Migration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Get the Volume ID by running the command, gluster volume info vol1. And use that Volume ID with Kadalu command as shown below (Note the Brick paths are unchanged)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>kadalu volume create PROD/vol1                     <span class="se">\</span>
<span class="go">      replica server1.example.com:/exports/vol1/s1   \
              server2.example.com:/exports/vol1/s2   \
              server3.example.com:/exports/vol1/s3   \
    --volume-id ea4fc0b9-f63b-4621-8c50-838e02ef08df</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_migration_helper">Using migration Helper</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="/images/import-gluster-volume.png" alt="Import Gluster Volume">
</div>
</div>
<div class="paragraph">
<p>Run the Gluster Volume info XML and then pipe it to the Kadalu Volume create command.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">#</span><span class="w"> </span>gluster volume info vol1 <span class="nt">--xml</span> | kadalu volume create PROD/- <span class="se">\</span>
<span class="go">    --auto-add-nodes</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This helper parses the Volume info and understands the Volume options used, type of Volume and many other details to recreate the Kadalu Volume. (<strong>Note</strong>: Volume Options support is a upcoming feature of Kadalu Storage)</p>
</div>
<div class="paragraph">
<p>If the node names used for Gluster are different from the ones to use with Kadalu then use the <code>--node-map</code> option.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">#</span><span class="w"> </span>gluster volume info vol1 <span class="nt">--xml</span> | kadalu volume create PROD/- <span class="se">\</span>
<span class="go">    --auto-add-nodes                                           \
    --node-map="server1.example.com=node1.example.com"         \
    --node-map="server2.example.com=node2.example.com"         \
    --node-map="server3.example.com=node3.example.com"</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To import all Volumes,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">#</span><span class="w"> </span>gluster volume list | xargs                               <span class="se">\</span>
<span class="go">    gluster volume info --xml | kadalu volume create PROD/- \
    --auto-add-nodes</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Kadalu Volumes are started by default on creation. If you want to stop using Kadalu and move back to Glusterd based Volume management, Stop the Kadalu Volume and Start the Gluster Volume. <strong>That&#8217;s all!</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>kadalu volume stop PROD/vol1
<span class="gp">#</span><span class="w"> </span>gluster volume start vol1</code></pre>
</div>
</div>
</div>
</div>
                    </div>
                </div>

                <div class="has-text-centered mb-6 notification is-light">
                    <p class="has-text-grey is-uppercase is-size-5 pb-2">About Aravinda VK</p>
                    
                    <p class="mb-4">Co-Founder, CTO - Kadalu Technologies</p>
                    
                    <p>
                        
                        <a class="mr-2" href="https://aravindavk.in">Website</a>|
                        
                        
                        <a class="mx-2" href="https://twitter.com/aravindavk">Twitter</a>|
                        
                        <a class="ml-2" href="https://github.com/aravindavk">Github</a>
                    </p>
                </div>
            </div>

        </div>
        <div class="footer has-background-info-25 has-text-white pt-6">
    <div class="columns">
        <div class="column">
            <h2 class="has-font-weight-semibold is-size-5 is-underlined py-2">Company</h2>
            <a class="is-block has-text-white" href="/about">About Us</a>
            <a class="is-block has-text-white" href="/blog">Blog Posts</a>
        </div>
        <div class="column">
            <h2 class="has-font-weight-semibold is-size-5 is-underlined py-2">Resources</h2>
            <a class="is-block has-text-white" href="/support">Support</a>
            <a class="is-block has-text-white" href="/security">Security</a>
            <a class="is-block has-text-white" href="/storage/quick-start">Gluster FS Quick start</a>
        </div>
        <div class="column">
            <h2 class="has-font-weight-semibold is-size-5 is-underlined py-2">Community</h2>
            <a class="is-block has-text-white" target="_blank" href="https://join.slack.com/t/kadalu/shared_invite/enQtNzg1ODQ0MDA5NTM2LWMzMTc5ZTJmMjk4MzI0YWVhOGFlZTJjZjY5MDNkZWI0Y2VjMDBlNzVkZmI1NWViN2U3MDNlNDJhNjE5OTBlOGU">Community Slack</a>
            <a class="is-block has-text-white" target="_blank" href="https://github.com/kadalu">Github</a>
        </div>

        <div class="column">
            <h2 class="has-font-weight-semibold is-size-5 is-underlined py-2">Contact Us</h2>
            <a class="is-block has-text-white" href="mailto:hello@kadalu.tech">Email to hello@kadalu.tech</a>
            <a class="is-block has-text-white" href="https://twitter.com/kadalu_tech">Twitter</a>
            <a class="is-block has-text-white" href="https://linkedin.com/kadalu_tech">Linkedin</a>
        </div>
    </div>
    <div class="has-text-centered mt-6">
        Copyright &copy; 2019-2024 Kadalu Technologies Private Limited.
    </div>
</div>

        </div>
    </body>
</html>
